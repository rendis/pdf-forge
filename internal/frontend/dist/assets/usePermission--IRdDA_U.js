import{f as M,b as O}from"./index-DLKA0qzp.js";const s={SUPERADMIN:"SUPERADMIN",PLATFORM_ADMIN:"PLATFORM_ADMIN"},C={OWNER:"TENANT_OWNER",ADMIN:"TENANT_ADMIN"},N={OWNER:"OWNER",ADMIN:"ADMIN",EDITOR:"EDITOR",OPERATOR:"OPERATOR",VIEWER:"VIEWER"},E={ADMIN_ACCESS:"admin:access",SYSTEM_TENANTS_VIEW:"system:tenants:view",SYSTEM_TENANTS_MANAGE:"system:tenants:manage",SYSTEM_USERS_VIEW:"system:users:view",SYSTEM_USERS_MANAGE:"system:users:manage",SYSTEM_SETTINGS_VIEW:"system:settings:view",SYSTEM_SETTINGS_MANAGE:"system:settings:manage",SYSTEM_AUDIT_VIEW:"system:audit:view",SYSTEM_INJECTABLES_VIEW:"system:injectables:view",SYSTEM_INJECTABLES_MANAGE:"system:injectables:manage",WORKSPACE_VIEW:"workspace:view",WORKSPACE_UPDATE:"workspace:update",WORKSPACE_ARCHIVE:"workspace:archive",MEMBERS_VIEW:"members:view",MEMBERS_INVITE:"members:invite",MEMBERS_REMOVE:"members:remove",MEMBERS_UPDATE_ROLE:"members:update_role",CONTENT_VIEW:"content:view",CONTENT_CREATE:"content:create",CONTENT_EDIT:"content:edit",CONTENT_DELETE:"content:delete",VERSION_VIEW:"version:view",VERSION_CREATE:"version:create",VERSION_EDIT_DRAFT:"version:edit_draft",VERSION_DELETE_DRAFT:"version:delete_draft",VERSION_PUBLISH:"version:publish",TENANT_CREATE:"tenant:create",TENANT_MANAGE_SETTINGS:"tenant:manage_settings",TENANT_MANAGE_WORKSPACES:"tenant:manage_workspaces",INJECTABLE_VIEW:"injectable:view",INJECTABLE_CREATE:"injectable:create",INJECTABLE_EDIT:"injectable:edit",INJECTABLE_DELETE:"injectable:delete",INJECTABLE_TOGGLE_STATUS:"injectable:toggle_status"},A=[E.WORKSPACE_VIEW,E.MEMBERS_VIEW,E.CONTENT_VIEW,E.VERSION_VIEW],n={[N.OWNER]:[...A,E.WORKSPACE_UPDATE,E.WORKSPACE_ARCHIVE,E.MEMBERS_INVITE,E.MEMBERS_REMOVE,E.MEMBERS_UPDATE_ROLE,E.CONTENT_CREATE,E.CONTENT_EDIT,E.CONTENT_DELETE,E.VERSION_CREATE,E.VERSION_EDIT_DRAFT,E.VERSION_DELETE_DRAFT,E.VERSION_PUBLISH,E.INJECTABLE_VIEW,E.INJECTABLE_CREATE,E.INJECTABLE_EDIT,E.INJECTABLE_DELETE,E.INJECTABLE_TOGGLE_STATUS],[N.ADMIN]:[...A,E.WORKSPACE_UPDATE,E.MEMBERS_INVITE,E.MEMBERS_REMOVE,E.CONTENT_CREATE,E.CONTENT_EDIT,E.CONTENT_DELETE,E.VERSION_CREATE,E.VERSION_EDIT_DRAFT,E.VERSION_DELETE_DRAFT,E.VERSION_PUBLISH,E.INJECTABLE_VIEW,E.INJECTABLE_CREATE,E.INJECTABLE_EDIT,E.INJECTABLE_DELETE,E.INJECTABLE_TOGGLE_STATUS],[N.EDITOR]:[...A,E.CONTENT_CREATE,E.CONTENT_EDIT,E.VERSION_CREATE,E.VERSION_EDIT_DRAFT,E.INJECTABLE_VIEW,E.INJECTABLE_CREATE,E.INJECTABLE_EDIT,E.INJECTABLE_TOGGLE_STATUS],[N.OPERATOR]:[...A,E.INJECTABLE_VIEW],[N.VIEWER]:[...A,E.INJECTABLE_VIEW]},V={[C.OWNER]:[E.TENANT_MANAGE_SETTINGS,E.TENANT_MANAGE_WORKSPACES],[C.ADMIN]:[E.TENANT_MANAGE_WORKSPACES]},D={[s.SUPERADMIN]:[E.ADMIN_ACCESS,E.SYSTEM_TENANTS_VIEW,E.SYSTEM_TENANTS_MANAGE,E.SYSTEM_USERS_VIEW,E.SYSTEM_USERS_MANAGE,E.SYSTEM_SETTINGS_VIEW,E.SYSTEM_SETTINGS_MANAGE,E.SYSTEM_AUDIT_VIEW,E.SYSTEM_INJECTABLES_VIEW,E.SYSTEM_INJECTABLES_MANAGE,E.TENANT_CREATE,E.TENANT_MANAGE_SETTINGS,E.TENANT_MANAGE_WORKSPACES,E.WORKSPACE_VIEW,E.WORKSPACE_UPDATE,E.WORKSPACE_ARCHIVE,E.MEMBERS_VIEW,E.MEMBERS_INVITE,E.MEMBERS_REMOVE,E.MEMBERS_UPDATE_ROLE,E.CONTENT_VIEW,E.CONTENT_CREATE,E.CONTENT_EDIT,E.CONTENT_DELETE,E.VERSION_VIEW,E.VERSION_CREATE,E.VERSION_EDIT_DRAFT,E.VERSION_DELETE_DRAFT,E.VERSION_PUBLISH,E.INJECTABLE_VIEW,E.INJECTABLE_CREATE,E.INJECTABLE_EDIT,E.INJECTABLE_DELETE,E.INJECTABLE_TOGGLE_STATUS],[s.PLATFORM_ADMIN]:[E.ADMIN_ACCESS,E.SYSTEM_TENANTS_VIEW,E.SYSTEM_TENANTS_MANAGE,E.SYSTEM_AUDIT_VIEW,E.SYSTEM_INJECTABLES_VIEW]};function i(){const{systemRoles:t}=M(),{currentTenant:S,currentWorkspace:I}=O(),e=_=>{for(const T of t){const R=D[T];if(R!=null&&R.includes(_))return!0}if(S!=null&&S.role){const T=V[S.role];if(T!=null&&T.includes(_))return!0}if(I!=null&&I.role){const T=n[I.role];if(T!=null&&T.includes(_))return!0}return!1};return{hasPermission:e,hasAnyPermission:_=>_.some(T=>e(T)),hasAllPermissions:_=>_.every(T=>e(T)),Permission:E}}export{E as P,i as u};
