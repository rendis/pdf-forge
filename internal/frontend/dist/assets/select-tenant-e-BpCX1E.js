import{a as de,u as ue,R as me,b as fe,r as a,c as ge,d as b,j as e,m as i,A as B,e as H}from"./index-Dpsg2V2Q.js";import{L as pe,T as xe}from"./ThemeToggle-CU1Nvxhn.js";import{u as he,P as Q}from"./useWorkspaces-CzRYWVIR.js";import{u as ye}from"./useMutation-D-Q9Jp0O.js";import{u as je}from"./dropdown-menu-Lx4gdXh6.js";import{F as be}from"./file-text-vCLWJ3XW.js";import{A as ve}from"./arrow-left-Ccq5vC3f.js";import{S as Ne}from"./search-PoKelCaX.js";import{A as _}from"./arrow-right-BNg6nvmp.js";import"./button-DqvbOdia.js";import"./i18n-Dwof1fLn.js";import"./chevron-left-CH5MA0xY.js";async function Te(n=1,c=20,d){return(await de.get("/me/tenants",{params:{page:n,perPage:c,...d&&{q:d}}})).data}function we(n=1,c=20,d){return ye({queryKey:["my-tenants",n,c,d],queryFn:()=>Te(n,c,d),staleTime:0,gcTime:0})}const K={hidden:{opacity:1},visible:{opacity:1,transition:{staggerChildren:.08}},exit:{opacity:0,y:-10,transition:{duration:.2}}},G={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,x:-20,transition:{duration:.2}}},V=5,Se=400;function q(){const[n,c]=a.useState("");return a.useEffect(()=>{const d=setInterval(()=>{c(l=>l.length>=3?"":l+".")},400);return()=>clearInterval(d)},[]),e.jsx("span",{className:"inline-block w-6 text-left",children:n})}function J(n){if(!n)return"Never";const c=new Date(n),l=new Date().getTime()-c.getTime(),u=Math.floor(l/6e4),f=Math.floor(l/36e5),x=Math.floor(l/864e5),y=Math.floor(x/7);return u<1?"Just now":u<60?`${u} min${u>1?"s":""} ago`:f<24?`${f} hour${f>1?"s":""} ago`:x<7?`${x} day${x>1?"s":""} ago`:`${y} week${y>1?"s":""} ago`}function Oe(){const{t:n}=je(),c=ue(),{intent:d}=me.useSearch(),l=d==="switch",{setCurrentTenant:u,setCurrentWorkspace:f,currentTenant:x,setSingleTenant:y,setSingleWorkspace:C}=fe(),[m,A]=a.useState(""),[s,v]=a.useState(l?x:null),[N,E]=a.useState(1),[T,L]=a.useState(1),[Y,U]=a.useState(1),[X,I]=a.useState(1),{startTransition:Z,setPhase:R,phase:W}=ge(),w=W!=="idle"&&W!=="complete",h=m.length>=3?m:void 0,{data:r,isLoading:D}=we(N,V,h),{data:o,isLoading:ee}=he((s==null?void 0:s.id)??null,T,V,s?h:void 0),g=r==null?void 0:r.pagination,p=o==null?void 0:o.pagination,[$,M]=a.useState(l),[te,z]=a.useState(!1);a.useEffect(()=>{if(l){M(!0);return}const t=setTimeout(()=>M(!0),1e3);return()=>clearTimeout(t)},[]),a.useEffect(()=>{L(1),I(1)},[s==null?void 0:s.id]),a.useEffect(()=>{E(1)},[m]),a.useEffect(()=>{if(m.length>0&&m.length<3){const t=setTimeout(()=>z(!0),300);return()=>clearTimeout(t)}else z(!1)},[m]),a.useEffect(()=>{g!=null&&g.totalPages&&U(g.totalPages)},[g==null?void 0:g.totalPages]),a.useEffect(()=>{p!=null&&p.totalPages&&I(p.totalPages)},[p==null?void 0:p.totalPages]);const S=a.useRef(!1),j=a.useRef(!1);a.useEffect(()=>{if(!l&&!S.current&&(r!=null&&r.data)&&r.pagination.total===1&&r.data.length===1&&!s&&!h){S.current=!0;const t=r.data[0];y(!0),u(t),v(t),b("TENANT",t.id).catch(()=>{})}},[r,s,h,u,y]),a.useEffect(()=>{if(!l&&!j.current&&s&&(o!=null&&o.data)&&o.pagination.total===1&&o.data.length===1&&!h){j.current=!0;const t=o.data[0];C(!0),f(t),b("WORKSPACE",t.id).catch(()=>{}),c({to:"/workspace/$workspaceId",params:{workspaceId:t.id}})}},[o,s,h,f,C,c]);const se=S.current&&!j.current&&!o,ae=j.current,ne=!$||D||!(r!=null&&r.data),oe=!$||ee||s&&!(o!=null&&o.data),F=(r==null?void 0:r.data)??[],O=(o==null?void 0:o.data)??[],re=t=>{A(""),u(t),v(t),b("TENANT",t.id).catch(()=>{})},ie=async(t,k)=>{const ce=k.currentTarget.getBoundingClientRect();Z({id:t.id,name:t.name},ce),await new Promise(P=>setTimeout(P,600)),R("fadeBorders"),await new Promise(P=>setTimeout(P,400)),R("fadeOut"),f(t),b("WORKSPACE",t.id).catch(()=>{}),c({to:"/workspace/$workspaceId",params:{workspaceId:t.id}})},le=()=>{s?(v(null),u(null)):c({to:"/login"})};return se||ae?e.jsx("div",{className:"min-h-screen bg-background"}):e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center bg-background pt-32 lg:pt-40",children:[e.jsxs(i.div,{layoutId:"app-logo",className:"absolute left-6 top-8 flex items-center gap-3 md:left-12 lg:left-32",children:[e.jsx(i.div,{layoutId:"app-logo-icon",className:"flex h-6 w-6 items-center justify-center border-2 border-foreground",children:e.jsx(be,{size:12,className:"text-foreground"})}),e.jsx(i.span,{layoutId:"app-logo-text",className:"font-display text-sm font-bold uppercase tracking-tight text-foreground",children:"PDF Forge"})]}),e.jsxs(i.div,{layoutId:"app-controls",className:"absolute right-6 top-8 flex items-center gap-1 md:right-12 lg:right-32",children:[e.jsx(pe,{}),e.jsx(xe,{})]}),e.jsxs(i.div,{animate:{opacity:w?0:1},transition:{duration:0},className:"mx-auto grid w-full max-w-7xl grid-cols-1 items-start gap-16 px-6 py-24 md:px-12 lg:grid-cols-12 lg:gap-24 lg:px-32",children:[e.jsxs(i.div,{layout:!0,className:"lg:sticky lg:top-32 lg:col-span-4",children:[e.jsx(B,{children:s&&e.jsxs(i.div,{layout:!0,initial:{opacity:0,y:-10},animate:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}},exit:{opacity:0,y:-10,transition:{duration:.4,ease:"easeIn"}},className:"mb-6",children:[e.jsx("span",{className:"font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:"Organization"}),e.jsx("p",{className:"mt-1 font-display text-lg font-medium tracking-tight text-foreground",children:s.name})]},"org-indicator")}),e.jsxs(i.div,{layout:!0,transition:{duration:.4,ease:"easeOut"},children:[e.jsx("h1",{className:"mb-8 font-display text-5xl font-light leading-[1.05] tracking-tighter text-foreground md:text-6xl",children:s?e.jsxs(e.Fragment,{children:["Select your",e.jsx("br",{}),e.jsx("span",{className:"font-semibold",children:"Workspace."})]}):e.jsxs(e.Fragment,{children:[n("selectTenant.title","Select your"),e.jsx("br",{}),e.jsx("span",{className:"font-semibold",children:n("selectTenant.subtitle","Organization.")})]})}),e.jsx("p",{className:"mb-12 max-w-sm text-lg font-light leading-relaxed text-muted-foreground",children:s?"Choose a workspace to access document templates and assembly tools.":n("selectTenant.description","Choose a tenant environment to access your document templates and assembly tools.")})]}),e.jsxs("button",{onClick:le,className:"group inline-flex items-center gap-2 font-mono text-sm text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(ve,{size:16,className:"transition-transform group-hover:-translate-x-1"}),e.jsx("span",{children:s?"Back to organizations":n("selectTenant.back","Back to login")})]})]}),e.jsxs("div",{className:"flex flex-col justify-center lg:col-span-8",children:[e.jsxs("div",{className:"group relative mb-8 w-full",children:[e.jsx(Ne,{className:"pointer-events-none absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-colors group-focus-within:text-foreground",size:20}),e.jsx("input",{type:"text",placeholder:s?"Filter by workspace...":n("selectTenant.filter","Filter by organization..."),value:m,onChange:t=>A(t.target.value),className:"w-full rounded-none border-b border-border bg-transparent py-3 pl-10 pr-4 font-display text-xl text-foreground outline-none transition-colors placeholder:text-muted-foreground/30 focus-visible:border-foreground focus-visible:ring-0"}),te&&e.jsx("span",{className:"absolute -bottom-6 left-0 text-xs text-muted-foreground/70",children:n("selectTenant.minChars","Type at least 3 characters to search")})]}),e.jsx("div",{className:"flex w-full flex-col justify-start",style:{height:`${Se}px`},children:e.jsx(B,{mode:"wait",children:s?oe?e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsxs("span",{children:["Loading workspaces",e.jsx(q,{})]})},"loading-workspaces"):O.length===0?e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsx("span",{children:n("common.noResults","No results found")})},"empty-workspaces"):e.jsx(i.div,{variants:K,initial:l?!1:"hidden",animate:"visible",exit:"exit",className:"flex h-full w-full flex-col justify-start",children:O.map(t=>e.jsxs(i.button,{variants:G,onClick:k=>ie(t,k),disabled:!!w,className:H("group relative -mb-px flex w-full items-center justify-between rounded-sm border border-transparent border-b-border px-4 py-6 outline-none transition-all duration-200 hover:z-10 hover:border-foreground hover:bg-accent",w&&"pointer-events-none"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-left font-display text-xl font-medium tracking-tight text-foreground md:text-2xl",children:t.name}),t.type==="SYSTEM"&&e.jsx("span",{className:"rounded-sm bg-muted px-1.5 py-0.5 font-mono text-[9px] font-bold uppercase tracking-widest text-muted-foreground",children:"System"})]}),e.jsxs("div",{className:"flex items-center gap-6 md:gap-8",children:[e.jsxs("span",{className:"whitespace-nowrap font-mono text-[10px] text-muted-foreground transition-colors group-hover:text-foreground md:text-xs",children:["Last accessed: ",J(t.lastAccessedAt)]}),e.jsx(_,{className:"text-muted-foreground transition-all duration-300 group-hover:translate-x-1 group-hover:text-foreground",size:24})]})]},t.id))},`workspaces-page-${T}-${m.length>=3?"search":"list"}`):ne?e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsxs("span",{children:["Loading organizations",e.jsx(q,{})]})},"loading-tenants"):F.length===0?e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsx("span",{children:n("common.noResults","No results found")})},"empty-tenants"):e.jsx(i.div,{variants:K,initial:l?!1:"hidden",animate:"visible",exit:"exit",className:"flex h-full w-full flex-col justify-start",children:F.map(t=>e.jsxs(i.button,{variants:G,onClick:()=>re(t),className:H("group relative -mb-px flex w-full items-center justify-between rounded-sm border border-transparent border-b-border px-4 py-6 outline-none transition-all duration-200 hover:z-10 hover:border-foreground hover:bg-accent"),children:[e.jsx("h3",{className:"text-left font-display text-xl font-medium tracking-tight text-foreground transition-transform duration-300 group-hover:translate-x-2 md:text-2xl",children:t.name}),e.jsxs("div",{className:"flex items-center gap-6 md:gap-8",children:[e.jsxs("span",{className:"whitespace-nowrap font-mono text-[10px] text-muted-foreground transition-colors group-hover:text-foreground md:text-xs",children:["Last accessed: ",J(t.lastAccessedAt)]}),e.jsx(_,{className:"text-muted-foreground transition-all duration-300 group-hover:translate-x-1 group-hover:text-foreground",size:24})]})]},t.id))},`tenants-page-${N}-${m.length>=3?"search":"list"}`)})}),!s&&e.jsx(Q,{page:N,totalPages:Y,onPageChange:E,className:"py-6"}),s&&e.jsx(Q,{page:T,totalPages:X,onPageChange:L,className:"py-6"}),"        "]})]})]})}export{Oe as component};
