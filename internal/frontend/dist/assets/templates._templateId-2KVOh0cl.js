import{r as l,j as e,X as A,u as le,b as de,e as k,L as we,T as W,k as _,n as K,B as lt,C as dt,M as ct,m as ee,A as ut,N as oe}from"./index-BQwHK-hb.js";import{S as te}from"./skeleton-C7B9TONZ.js";import{u as mt}from"./page-transition-store-JHVp3QLc.js";import{D as xt}from"./templates-api-BYJzcbMp.js";import{i as pt,j as gt,k as ft,l as ht,m as bt,a as jt,b as vt,T as Nt,u as yt,g as wt,n as Dt,o as kt,p as Ct,D as St,h as Tt}from"./DocumentTypeConflictDialog-8-ZSVbMC.js";import{D as I,B as E,T as z,a as V,c as P,b as L}from"./dialog-DickdHhf.js";import{u as C}from"./dropdown-menu-C7jJ2Coz.js";import{P as Se,a as At}from"./plus-CF1qwSfP.js";import{I as It,C as Te,a as Et,b as Vt,c as Pt,S as Lt,d as Ft}from"./send-Cg4syLHk.js";import{E as Ht,A as ae,C as Ae,T as Rt,F as Ut}from"./trash-2-D47sQoYh.js";import{C as ie}from"./clock-CudxwUdT.js";import{A as Bt}from"./arrow-left-1019-Ma7.js";import{F as zt}from"./folder-open-BIADOphw.js";import{L as Ot}from"./layers-D_m6wgY3.js";import{F as De}from"./file-text-BQtqwPe2.js";import"./useMutation-DuLT7JZ1.js";import"./search-Cx9wyynW.js";import"./useDocumentTypes-BB9lLLvS.js";import"./chevron-down-S0CCasQE.js";import"./index-BUG7Fq1L.js";function $t({open:t,onOpenChange:a,version:r,templateId:s}){const{t:n}=C(),[o,c]=l.useState(!1),d=pt(s),u=async()=>{if(!(!r||o)){c(!0);try{await d.mutateAsync(r.id),a(!1)}catch{}finally{c(!1)}}};return e.jsx(I,{open:t,onOpenChange:a,children:e.jsxs(E,{className:"max-w-md",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center bg-destructive/10",children:e.jsx(z,{className:"h-5 w-5 text-destructive"})}),e.jsx("div",{children:e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:n("templates.versionArchiveDialog.title","Archive Version")})})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsx("div",{className:"p-6",children:e.jsx(L,{className:"text-sm font-light text-muted-foreground",children:n("templates.versionArchiveDialog.message","Are you sure you want to archive version {{version}}? This action cannot be undone.",{version:(r==null?void 0:r.versionNumber)??""})})}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:o,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:n("common.cancel","Cancel")}),e.jsx("button",{type:"button",onClick:u,disabled:o,className:"rounded-none bg-destructive px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-destructive-foreground transition-colors hover:bg-destructive/90 disabled:opacity-50",children:o?n("common.archiving","Archiving..."):n("templates.versionArchiveDialog.confirm","Archive")})]})]})})}function Mt({open:t,onOpenChange:a,version:r,templateId:s}){const{t:n}=C(),[o,c]=l.useState(!1),d=gt(s),u=async()=>{if(!(!r||o)){c(!0);try{await d.mutateAsync(r.id),a(!1)}catch{}finally{c(!1)}}};return e.jsx(I,{open:t,onOpenChange:a,children:e.jsxs(E,{className:"max-w-md",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center bg-destructive/10",children:e.jsx(z,{className:"h-5 w-5 text-destructive"})}),e.jsx("div",{children:e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:n("templates.versionCancelScheduleDialog.title","Cancel Scheduled Publication")})})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsx("div",{className:"p-6",children:e.jsx(L,{className:"text-sm font-light text-muted-foreground",children:n("templates.versionCancelScheduleDialog.message","Are you sure you want to cancel the scheduled publication of version {{version}}?",{version:(r==null?void 0:r.versionNumber)??""})})}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:o,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:n("common.cancel","Cancel")}),e.jsx("button",{type:"button",onClick:u,disabled:o,className:"rounded-none bg-destructive px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-destructive-foreground transition-colors hover:bg-destructive/90 disabled:opacity-50",children:o?n("common.cancelling","Cancelling..."):n("templates.versionCancelScheduleDialog.confirm","Cancel Schedule")})]})]})})}function Wt({open:t,onOpenChange:a,templateId:r,sourceVersion:s}){const{t:n}=C(),o=le(),{currentWorkspace:c}=de(),[d,u]=l.useState(""),[p,j]=l.useState(""),[f,v]=l.useState(!1),g=ft(r),w=l.useCallback(h=>{h&&(u(""),j(""),v(!1)),a(h)},[a]),x=async h=>{if(h.preventDefault(),!(!d.trim()||!c||!s||f)){v(!0);try{const X=await g.mutateAsync({sourceVersionId:s.id,name:d.trim(),description:p.trim()||void 0});a(!1),o({to:"/workspace/$workspaceId/editor/$templateId/version/$versionId",params:{workspaceId:c.id,templateId:r,versionId:X.id}})}catch{v(!1)}}};return s?e.jsx(I,{open:t,onOpenChange:w,children:e.jsxs(E,{className:"max-w-lg",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{children:[e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:n("templates.cloneVersionDialog.title","Clonar Versión")}),e.jsx(L,{className:"mt-1 text-sm font-light text-muted-foreground",children:n("templates.cloneVersionDialog.description","Crear una nueva versión a partir de {{versionName}}",{versionName:s.name})}),e.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:n("templates.cloneVersionDialog.sourceVersion","Versión origen: v{{versionNumber}} - {{versionName}}",{versionNumber:s.versionNumber,versionName:s.name})})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"clone-version-name",className:"mb-2 block font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:n("templates.createVersionDialog.nameLabel","Version Name")}),e.jsx("input",{id:"clone-version-name",type:"text",value:d,onChange:h=>u(h.target.value),placeholder:n("templates.createVersionDialog.namePlaceholder","e.g., Initial Draft, Review Changes..."),maxLength:100,autoFocus:!0,className:"w-full rounded-none border-0 border-b border-border bg-transparent py-2 text-base font-light text-foreground outline-none transition-all placeholder:text-muted-foreground/50 focus-visible:border-foreground focus-visible:ring-0"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"clone-version-description",className:"mb-2 block font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:[n("templates.createVersionDialog.descriptionLabel","Description"),e.jsxs("span",{className:"ml-2 normal-case tracking-normal text-muted-foreground/60",children:["(",n("common.optional","optional"),")"]})]}),e.jsx("textarea",{id:"clone-version-description",value:p,onChange:h=>j(h.target.value),placeholder:n("templates.createVersionDialog.descriptionPlaceholder","Optional description of changes..."),rows:3,className:"w-full resize-none rounded-none border-0 border-b border-border bg-transparent py-2 text-base font-light text-foreground outline-none transition-all placeholder:text-muted-foreground/50 focus-visible:border-foreground focus-visible:ring-0"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:f,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:n("common.cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:!d.trim()||f,className:"rounded-none bg-foreground px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-background transition-colors hover:bg-foreground/90 disabled:opacity-50",children:f?n("common.creating","Creando..."):n("templates.cloneVersionDialog.submit","Clonar Versión")})]})]})]})}):null}function _t({open:t,onOpenChange:a,templateId:r}){const{t:s}=C(),n=le(),{currentWorkspace:o}=de(),[c,d]=l.useState(""),[u,p]=l.useState(""),[j,f]=l.useState(!1),v=ht(r),g=l.useCallback(x=>{x&&(d(""),p(""),f(!1)),a(x)},[a]),w=async x=>{if(x.preventDefault(),!(!c.trim()||!o||j)){f(!0);try{const h=await v.mutateAsync({name:c.trim(),description:u.trim()||void 0});a(!1),n({to:"/workspace/$workspaceId/editor/$templateId/version/$versionId",params:{workspaceId:o.id,templateId:r,versionId:h.id}})}catch{f(!1)}}};return e.jsx(I,{open:t,onOpenChange:g,children:e.jsxs(E,{className:"max-w-lg",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{children:[e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:s("templates.createVersionDialog.title","New Version")}),e.jsx(L,{className:"mt-1 text-sm font-light text-muted-foreground",children:s("templates.createVersionDialog.description","Create a new version of this template")})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"version-name",className:"mb-2 block font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:s("templates.createVersionDialog.nameLabel","Version Name")}),e.jsx("input",{id:"version-name",type:"text",value:c,onChange:x=>d(x.target.value),placeholder:s("templates.createVersionDialog.namePlaceholder","e.g., Initial Draft, Review Changes..."),maxLength:100,autoFocus:!0,className:"w-full rounded-none border-0 border-b border-border bg-transparent py-2 text-base font-light text-foreground outline-none transition-all placeholder:text-muted-foreground/50 focus-visible:border-foreground focus-visible:ring-0"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"version-description",className:"mb-2 block font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:[s("templates.createVersionDialog.descriptionLabel","Description"),e.jsxs("span",{className:"ml-2 normal-case tracking-normal text-muted-foreground/60",children:["(",s("common.optional","optional"),")"]})]}),e.jsx("textarea",{id:"version-description",value:u,onChange:x=>p(x.target.value),placeholder:s("templates.createVersionDialog.descriptionPlaceholder","Optional description of changes..."),rows:3,className:"w-full resize-none rounded-none border-0 border-b border-border bg-transparent py-2 text-base font-light text-foreground outline-none transition-all placeholder:text-muted-foreground/50 focus-visible:border-foreground focus-visible:ring-0"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:j,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:s("common.cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:!c.trim()||j,className:"rounded-none bg-foreground px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-background transition-colors hover:bg-foreground/90 disabled:opacity-50",children:j?s("common.creating","Creating..."):s("templates.createVersionDialog.submit","Create Version")})]})]})]})})}function Kt({open:t,onOpenChange:a,version:r,templateId:s}){const{t:n}=C(),[o,c]=l.useState(!1),d=bt(s),u=async()=>{if(!(!r||o)){c(!0);try{await d.mutateAsync(r.id),a(!1)}catch{}finally{c(!1)}}};return e.jsx(I,{open:t,onOpenChange:a,children:e.jsxs(E,{className:"max-w-md",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center bg-destructive/10",children:e.jsx(z,{className:"h-5 w-5 text-destructive"})}),e.jsx("div",{children:e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:n("templates.versionDeleteDialog.title","Delete Version")})})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsx("div",{className:"p-6",children:e.jsx(L,{className:"text-sm font-light text-muted-foreground",children:n("templates.versionDeleteDialog.message","Are you sure you want to delete version {{version}}? This action cannot be undone.",{version:(r==null?void 0:r.versionNumber)??""})})}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:o,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:n("common.cancel","Cancel")}),e.jsx("button",{type:"button",onClick:u,disabled:o,className:"rounded-none bg-destructive px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-destructive-foreground transition-colors hover:bg-destructive/90 disabled:opacity-50",children:o?n("common.deleting","Deleting..."):n("templates.versionDeleteDialog.confirm","Delete")})]})]})})}function Xt({value:t,onSave:a,isLoading:r=!1,className:s}){const[n,o]=l.useState(!1),[c,d]=l.useState(t),[u,p]=l.useState(!1),j=l.useRef(null);l.useEffect(()=>{!n&&!u&&d(t)},[t,n,u]),l.useEffect(()=>{n&&j.current&&(j.current.focus(),j.current.select())},[n]);const f=async()=>{const x=c.trim();if(!x||x===t){d(t),o(!1);return}p(!0),o(!1);try{await a(x)}catch{d(t)}finally{p(!1)}},v=x=>{x.key==="Enter"?(x.preventDefault(),f()):x.key==="Escape"&&(d(t),o(!1))},g=()=>{!r&&!u&&o(!0)},w=r||u;return n?e.jsxs("div",{className:"relative flex items-center gap-3",children:[e.jsx("input",{ref:j,value:c,onChange:x=>d(x.target.value),onBlur:f,onKeyDown:v,disabled:w,className:k("w-full bg-transparent border-b-2 border-primary outline-none","disabled:opacity-50",s)}),w&&e.jsx(we,{className:"h-5 w-5 shrink-0 animate-spin text-muted-foreground"})]}):e.jsxs("div",{onClick:g,className:k("group relative flex w-full cursor-text items-center rounded px-2 py-1 -mx-2 -my-1","transition-all duration-150","hover:bg-muted/40",w&&"pointer-events-none"),children:[e.jsx("span",{className:k("min-w-0 flex-1 truncate",s),children:t}),w?e.jsx(we,{className:"ml-3 h-5 w-5 shrink-0 animate-spin text-muted-foreground"}):e.jsx(Se,{size:18,className:"ml-3 shrink-0 text-muted-foreground opacity-0 transition-opacity group-hover:opacity-60"})]})}function Gt({open:t,onOpenChange:a,templateId:r,currentTags:s}){const{t:n}=C(),[o,c]=l.useState([]),[d,u]=l.useState(!1),p=jt(),j=vt();l.useEffect(()=>{t&&(c(s.map(v=>v.id)),u(!1))},[t,s]);const f=async v=>{if(v.preventDefault(),!d){u(!0);try{const g=s.map(h=>h.id),w=o.filter(h=>!g.includes(h)),x=g.filter(h=>!o.includes(h));w.length>0&&await p.mutateAsync({templateId:r,tagIds:w});for(const h of x)await j.mutateAsync({templateId:r,tagId:h});a(!1)}catch{}finally{u(!1)}}};return e.jsx(I,{open:t,onOpenChange:a,children:e.jsxs(E,{className:"max-w-lg",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{children:[e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:n("templates.editTagsDialog.title","Edit Tags")}),e.jsx(L,{className:"mt-1 text-sm font-light text-muted-foreground",children:n("templates.editTagsDialog.description","Add or remove tags from this template")})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("form",{onSubmit:f,children:[e.jsx("div",{className:"p-6",children:e.jsx(Nt,{selectedTagIds:o,onSelectionChange:c})}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:d,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:n("common.cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:d,className:"rounded-none bg-foreground px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-background transition-colors hover:bg-foreground/90 disabled:opacity-50",children:d?n("common.saving","Saving..."):n("templates.editTagsDialog.submit","Save Tags")})]})]})]})})}function Yt({open:t,onOpenChange:a,version:r,onConfirm:s,isLoading:n}){const{t:o}=C();return r?e.jsx(I,{open:t,onOpenChange:a,children:e.jsxs(E,{className:"max-w-md",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{children:[e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:o("templates.publishDialog.title","Publish Version")}),e.jsx(L,{className:"mt-1 text-sm font-light text-muted-foreground",children:o("templates.publishDialog.description",'Make version "{{name}}" live',{name:r.name})})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex gap-3 rounded-md border border-warning-border bg-warning-muted p-4",children:[e.jsx(z,{className:"h-5 w-5 shrink-0 text-warning"}),e.jsxs("div",{className:"text-sm text-warning-foreground",children:[e.jsx("p",{className:"font-medium",children:o("templates.publishDialog.warningTitle","This action will:")}),e.jsxs("ul",{className:"mt-2 list-inside list-disc space-y-1 opacity-80",children:[e.jsx("li",{children:o("templates.publishDialog.warning1","Replace the current published version")}),e.jsx("li",{children:o("templates.publishDialog.warning2","Make this content immediately available")})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:n,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:o("common.cancel","Cancel")}),e.jsx("button",{type:"button",onClick:s,disabled:n,className:"rounded-none bg-foreground px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-background transition-colors hover:bg-foreground/90 disabled:opacity-50",children:n?o("common.publishing","Publishing..."):o("templates.publishDialog.confirm","Publish Now")})]})]})}):null}function Ie(){return new Date().toISOString().split("T")[0]}function qt(t){const a=Ie();if(t===a){const r=new Date;return r.setMinutes(r.getMinutes()+5),r.toTimeString().slice(0,5)}return"00:00"}function Jt({open:t,onOpenChange:a,version:r,onConfirm:s,isLoading:n}){const{t:o}=C(),[c,d]=l.useState(""),[u,p]=l.useState(""),j=l.useCallback(g=>{a(g)},[a]),f=()=>{if(!c||!u)return;const g=new Date(`${c}T${u}`).toISOString();s(g),d(""),p("")},v=c&&u;return r?e.jsx(I,{open:t,onOpenChange:j,children:e.jsxs(E,{className:"max-w-md",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{children:[e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-foreground",children:o("templates.scheduleDialog.title","Schedule Publication")}),e.jsx(L,{className:"mt-1 text-sm font-light text-muted-foreground",children:o("templates.scheduleDialog.description",'Schedule when "{{name}}" will go live',{name:r.name})})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"publish-date",className:"mb-2 block font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:o("templates.scheduleDialog.dateLabel","Publish Date")}),e.jsx("input",{id:"publish-date",type:"date",value:c,onChange:g=>d(g.target.value),min:Ie(),className:"w-full rounded-none border-0 border-b border-border bg-transparent py-2 text-base font-light text-foreground outline-none transition-all focus-visible:border-foreground focus-visible:ring-0 dark:scheme-dark"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"publish-time",className:"mb-2 block font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:o("templates.scheduleDialog.timeLabel","Publish Time")}),e.jsx("input",{id:"publish-time",type:"time",value:u,onChange:g=>p(g.target.value),min:c?qt(c):void 0,className:"w-full rounded-none border-0 border-b border-border bg-transparent py-2 text-base font-light text-foreground outline-none transition-all focus-visible:border-foreground focus-visible:ring-0 dark:scheme-dark"})]}),e.jsxs("div",{className:"flex gap-3 rounded-md border border-info-border bg-info-muted p-4",children:[e.jsx(It,{className:"h-5 w-5 shrink-0 text-info"}),e.jsx("p",{className:"text-sm text-info-foreground",children:o("templates.scheduleDialog.info","The version will be published automatically at the scheduled time. You can cancel anytime before then.")})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),disabled:n,className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground disabled:opacity-50",children:o("common.cancel","Cancel")}),e.jsx("button",{type:"button",onClick:f,disabled:!v||n,className:"rounded-none bg-foreground px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-background transition-colors hover:bg-foreground/90 disabled:opacity-50",children:n?o("common.scheduling","Scheduling..."):o("templates.scheduleDialog.confirm","Schedule")})]})]})},r.id):null}function Qt({tag:t,className:a}){const r=typeof t=="string"?t:t.name,s=typeof t=="object"?t.color:void 0;return e.jsxs("span",{className:k("inline-flex items-center gap-1 rounded-sm bg-muted px-1.5 py-0.5 font-mono text-xs text-muted-foreground",a),children:[s&&e.jsx("span",{className:"h-2 w-2 shrink-0 rounded-full",style:{backgroundColor:s}}),r]})}function Zt({open:t,onOpenChange:a,validation:r,onOpenEditor:s}){const{t:n}=C();if(!r)return null;const o=r.errors&&r.errors.length>0,c=r.warnings&&r.warnings.length>0;return e.jsx(I,{open:t,onOpenChange:a,children:e.jsxs(E,{className:"max-w-lg",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-border p-6",children:[e.jsxs("div",{children:[e.jsx(V,{className:"font-mono text-sm font-medium uppercase tracking-widest text-destructive",children:n("templates.validationDialog.title","Validation Errors")}),e.jsx(L,{className:"mt-1 text-sm font-light text-muted-foreground",children:n("templates.validationDialog.description","Cannot publish version due to content errors")})]}),e.jsxs(P,{className:"text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("div",{className:"max-h-[400px] overflow-y-auto p-6",children:[o&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2 text-destructive",children:[e.jsx(Te,{size:16}),e.jsxs("span",{className:"font-mono text-xs font-medium uppercase tracking-widest",children:[n("templates.validationDialog.errors","Errors")," (",r.errors.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:r.errors.map((d,u)=>e.jsxs("div",{className:"border-l-2 border-destructive bg-destructive/5 py-2 pl-3 pr-2",children:[e.jsx("p",{className:"text-sm text-foreground",children:d.message}),e.jsx("p",{className:"mt-1 font-mono text-[10px] text-muted-foreground",children:d.path})]},u))})]}),c&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2 text-warning",children:[e.jsx(z,{size:16}),e.jsxs("span",{className:"font-mono text-xs font-medium uppercase tracking-widest",children:[n("templates.validationDialog.warnings","Warnings")," (",r.warnings.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:r.warnings.map((d,u)=>e.jsxs("div",{className:"border-l-2 border-warning-border bg-warning-muted/50 py-2 pl-3 pr-2",children:[e.jsx("p",{className:"text-sm text-foreground",children:d.message}),e.jsx("p",{className:"mt-1 font-mono text-[10px] text-muted-foreground",children:d.path})]},u))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-border p-6",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"rounded-none border border-border bg-background px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-muted-foreground transition-colors hover:border-foreground hover:text-foreground",children:n("common.close","Close")}),s&&e.jsx("button",{type:"button",onClick:()=>{a(!1),s()},className:"rounded-none bg-foreground px-6 py-2.5 font-mono text-xs uppercase tracking-wider text-background transition-colors hover:bg-foreground/90",children:n("templates.validationDialog.openEditor","Open in Editor")})]})]})})}const ke={DRAFT:{label:"Draft",badgeClass:"border-warning-border/50 bg-warning-muted text-warning-foreground",dotClass:"bg-warning"},SCHEDULED:{label:"Scheduled",badgeClass:"border-info-border/50 bg-info-muted text-info-foreground",dotClass:"bg-info"},PUBLISHED:{label:"Published",badgeClass:"border-success-border/50 bg-success-muted text-success-foreground",dotClass:"bg-success"},ARCHIVED:{label:"Archived",badgeClass:"border-muted-foreground/30 bg-muted text-muted-foreground",dotClass:"bg-muted-foreground"}};function es({status:t}){const a=ke[t]||ke.DRAFT;return e.jsxs("span",{className:k("inline-flex items-center gap-1.5 border px-2 py-0.5 font-mono text-[10px] uppercase tracking-widest",a.badgeClass),children:[e.jsx("span",{className:k("h-1.5 w-1.5 rounded-full",a.dotClass)}),a.label]})}function se(t){return t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null}function $({icon:t,label:a,onClick:r,variant:s="default"}){return e.jsxs(W,{children:[e.jsx(_,{asChild:!0,children:e.jsx("button",{onClick:n=>{n.stopPropagation(),r()},className:`flex h-9 w-9 items-center justify-center rounded-sm transition-colors ${s==="destructive"?"text-muted-foreground hover:bg-destructive/10 hover:text-destructive":"text-muted-foreground hover:bg-accent hover:text-foreground"}`,children:t})}),e.jsx(K,{side:"top",className:"font-mono text-xs",children:a})]})}function ts({version:t,onOpenEditor:a,onPublish:r,onSchedule:s,onCancelSchedule:n,onArchive:o,onDelete:c,onClone:d,isHighlighted:u=!1}){const{t:p}=C(),j=t.status==="DRAFT"||t.status==="SCHEDULED",f=t.status==="DRAFT",v=t.status==="SCHEDULED",g=t.status==="PUBLISHED",w=t.status==="DRAFT",x=!!d,h=j||f||v||g||w||x;return e.jsxs("div",{onClick:()=>a(t.id),className:k("group cursor-pointer border-b border-border px-4 py-4 transition-colors hover:bg-accent",u&&"animate-pulse-highlight"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"flex h-8 w-8 shrink-0 items-center justify-center border border-border bg-background font-mono text-xs font-medium",children:["v",t.versionNumber]}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-foreground",children:t.name}),e.jsx(Ht,{size:14,className:"text-muted-foreground opacity-0 transition-opacity group-hover:opacity-100"})]}),t.description&&e.jsx("p",{className:"mt-0.5 text-sm text-muted-foreground line-clamp-1",children:t.description})]})]}),e.jsx(es,{status:t.status})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between pl-11",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{size:12}),p("templates.versionInfo.createdAt","Created"),": ",se(t.createdAt)]}),t.scheduledPublishAt&&e.jsxs("span",{className:"flex items-center gap-1 text-info",children:[e.jsx(Et,{size:12}),p("templates.versionInfo.scheduledAt","Scheduled"),":"," ",se(t.scheduledPublishAt)]}),t.publishedAt&&e.jsxs("span",{className:"flex items-center gap-1 text-success",children:[e.jsx(Vt,{size:12}),p("templates.versionInfo.publishedAt","Published"),": ",se(t.publishedAt)]}),t.archivedAt&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{size:12}),p("templates.versionInfo.archivedAt","Archived"),": ",se(t.archivedAt)]})]}),h&&e.jsxs("div",{className:"flex items-center gap-1",children:[x&&e.jsx($,{icon:e.jsx(Pt,{size:18}),label:p("templates.versions.actions.clone","Clonar versión"),onClick:()=>d==null?void 0:d(t)}),j&&e.jsx($,{icon:e.jsx(Lt,{size:18}),label:p("templates.versions.actions.publishNow","Publish Now"),onClick:()=>r==null?void 0:r(t)}),f&&e.jsx($,{icon:e.jsx(Ae,{size:18}),label:p("templates.versions.actions.schedule","Schedule"),onClick:()=>s==null?void 0:s(t)}),v&&e.jsx($,{icon:e.jsx(Te,{size:18}),label:p("templates.versions.actions.cancelSchedule","Cancel Schedule"),onClick:()=>n==null?void 0:n(t)}),g&&e.jsx($,{icon:e.jsx(ae,{size:18}),label:p("templates.versions.actions.archive","Archive"),onClick:()=>o==null?void 0:o(t)}),w&&e.jsx($,{icon:e.jsx(Rt,{size:18}),label:p("templates.versions.actions.delete","Delete"),onClick:()=>c==null?void 0:c(t),variant:"destructive"})]})]})]})}function Ce(t){return t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}function ss(){var ye;const{templateId:t}=lt({from:"/workspace/$workspaceId/templates/$templateId"}),{fromFolderId:a}=dt({from:"/workspace/$workspaceId/templates/$templateId"}),{currentWorkspace:r}=de(),{t:s}=C(),{toast:n}=ct(),o=le(),[c,d]=l.useState(!1),[u,p]=l.useState(!1),[j,f]=l.useState(!1),[v,g]=l.useState(!1),[w,x]=l.useState(!1),[h,X]=l.useState(null),[F,G]=l.useState(null),[Ee,ce]=l.useState(!1),[Ve,Pe]=l.useState(null),[Le,ue]=l.useState(!1),[Fe,He]=l.useState(null),[Re,me]=l.useState(!1),[Ue,Be]=l.useState(null),[ze,xe]=l.useState(!1),[Oe,$e]=l.useState(null),[Y,q]=l.useState({open:!1,conflict:null,pendingTypeId:null}),pe=yt(),J=wt(),ge=Dt(t),fe=kt(t),Me=async i=>{await pe.mutateAsync({templateId:t,data:{title:i}})},We=async i=>{try{await J.mutateAsync({templateId:t,data:{documentTypeId:i}})}catch(y){if(y instanceof xt){q({open:!0,conflict:y.conflict,pendingTypeId:i});return}throw y}},_e=async()=>{if(Y.pendingTypeId)try{await J.mutateAsync({templateId:t,data:{documentTypeId:Y.pendingTypeId,force:!0}}),q({open:!1,conflict:null,pendingTypeId:null})}catch(i){throw q({open:!1,conflict:null,pendingTypeId:null}),i}},Ke=()=>{q({open:!1,conflict:null,pendingTypeId:null})},{isTransitioning:Xe,direction:re,startTransition:Ge,endTransition:he}=mt(),[be,je]=l.useState(re!=="forward"),[rs,Ye]=l.useState(!1);l.useEffect(()=>{if(re==="forward"){const i=setTimeout(()=>{je(!0),he()},50);return()=>clearTimeout(i)}},[re,he]);const{data:m,isLoading:qe,error:Je}=Ct(t),Qe=!!m,N=l.useMemo(()=>m!=null&&m.versions?m.versions.reduce((i,y)=>(i[y.status]=(i[y.status]||0)+1,i),{PUBLISHED:0,SCHEDULED:0,DRAFT:0,ARCHIVED:0}):{PUBLISHED:0,SCHEDULED:0,DRAFT:0,ARCHIVED:0},[m==null?void 0:m.versions]),[M,Q]=l.useState({PUBLISHED:!0,SCHEDULED:!0,DRAFT:!0,ARCHIVED:!0}),O=l.useMemo(()=>({PUBLISHED:M.PUBLISHED&&N.PUBLISHED>0,SCHEDULED:M.SCHEDULED&&N.SCHEDULED>0,DRAFT:M.DRAFT&&N.DRAFT>0,ARCHIVED:M.ARCHIVED&&N.ARCHIVED>0}),[M,N]),Z=m==null?void 0:m.versions,ne=l.useMemo(()=>{if(!Z||Z.length===0)return[];const i=Z.filter(b=>O[b.status]),y=b=>b.updatedAt?new Date(b.updatedAt).getTime():new Date(b.createdAt).getTime(),S=[],T=[],D=[],U=[];for(const b of i)b.status==="PUBLISHED"?S.push(b):b.status==="SCHEDULED"?T.push(b):b.status==="DRAFT"?D.push(b):b.status==="ARCHIVED"&&U.push(b);return T.sort((b,B)=>{if(!b.scheduledPublishAt&&!B.scheduledPublishAt)return 0;if(!b.scheduledPublishAt)return 1;if(!B.scheduledPublishAt)return-1;const H=new Date(b.scheduledPublishAt).getTime(),R=new Date(B.scheduledPublishAt).getTime();return isNaN(H)||isNaN(R)?0:H-R}),D.sort((b,B)=>{const H=y(b),R=y(B);return isNaN(H)||isNaN(R)?0:R-H}),U.sort((b,B)=>{const H=y(b),R=y(B);return isNaN(H)||isNaN(R)?0:R-H}),[...S,...T,...D,...U]},[Z,O]),ve=()=>{r&&!Xe&&(Ge("backward"),Ye(!0),je(!1),setTimeout(()=>{o(a?{to:"/workspace/$workspaceId/documents",params:{workspaceId:r.id},search:a==="root"?void 0:{folderId:a}}:{to:"/workspace/$workspaceId/templates",params:{workspaceId:r.id}})},300))},Ne=i=>{r&&o({to:"/workspace/$workspaceId/editor/$templateId/version/$versionId",params:{workspaceId:r.id,templateId:t,versionId:i}})},Ze=()=>{!r||!(m!=null&&m.folderId)||o({to:"/workspace/$workspaceId/documents",params:{workspaceId:r.id},search:{folderId:m.folderId}})},et=i=>{G(i),f(!0)},tt=i=>{G(i),g(!0)},st=async()=>{var i,y;if(F)try{await ge.mutateAsync(F.id),f(!1),G(null)}catch(S){if(oe.isAxiosError(S)&&((i=S.response)==null?void 0:i.status)===422){const T=(y=S.response.data)==null?void 0:y.validation;if(T){X(T),f(!1),x(!0);return}}throw S}},rt=async i=>{var y,S,T;if(F)try{await fe.mutateAsync({versionId:F.id,publishAt:i}),g(!1),G(null)}catch(D){if(oe.isAxiosError(D)&&((y=D.response)==null?void 0:y.status)===409&&D.response.data.error==="another version is already scheduled at this time"){n({variant:"destructive",title:s("templates.scheduleDialog.error.conflictTitle","Scheduling Conflict"),description:s("templates.scheduleDialog.error.conflictDescription","Another version is already scheduled at this time.")});return}if(oe.isAxiosError(D)&&((S=D.response)==null?void 0:S.status)===422){const U=(T=D.response.data)==null?void 0:T.validation;if(U){X(U),g(!1),x(!0);return}}throw D}},nt=i=>{Be(i),me(!0)},ot=i=>{He(i),ue(!0)},at=i=>{Pe(i),ce(!0)},it=i=>{$e(i),xe(!0)};return qe&&!Qe?e.jsxs(ee.div,{className:"flex h-full flex-1 flex-col bg-background",initial:{opacity:0},animate:{opacity:be?1:0},transition:{duration:.25,ease:"easeOut"},children:[e.jsxs("header",{className:"shrink-0 px-4 pb-6 pt-12 md:px-6 lg:px-6",children:[e.jsx(te,{className:"h-4 w-32"}),e.jsx(te,{className:"mt-4 h-10 w-64"})]}),e.jsx("div",{className:"flex-1 px-4 pb-12 md:px-6 lg:px-6",children:e.jsxs("div",{className:"grid gap-8 lg:grid-cols-[1fr_1.5fr]",children:[e.jsx(te,{className:"h-64"}),e.jsx(te,{className:"h-96"})]})})]}):Je||!m?e.jsxs("div",{className:"flex h-full flex-1 flex-col items-center justify-center bg-background",children:[e.jsx("p",{className:"text-lg text-muted-foreground",children:s("templates.detail.notFound","Template not found")}),e.jsx("button",{onClick:ve,className:"mt-4 text-sm text-foreground underline underline-offset-4 hover:no-underline",children:a?s("templates.detail.backToFolder","Back to Folder"):s("templates.detail.backToList","Back to Templates")})]}):e.jsxs(ee.div,{className:"flex h-full flex-1 flex-col bg-background",initial:{opacity:0},animate:{opacity:be?1:0},transition:{duration:.25,ease:"easeOut"},children:[e.jsx("div",{className:"sticky top-0 z-40 h-0",children:e.jsx(ut,{initial:!1,children:m.versions.some(i=>i.status==="PUBLISHED")&&!m.documentTypeId&&e.jsx(ee.div,{initial:{y:-40,opacity:0},animate:{y:0,opacity:1},exit:{y:-40,opacity:0},transition:{duration:.25,ease:"easeInOut"},children:e.jsxs("div",{className:"flex items-center gap-2 border-b border-warning/30 bg-warning-muted/60 px-6 py-2 dark:bg-warning-muted/50",children:[e.jsx(z,{className:"h-4 w-4 shrink-0 text-warning dark:text-warning-border"}),e.jsx("span",{className:"text-sm text-warning-foreground",children:s("templates.warnings.noDocumentTypeDescription","This template has a published version but no document type. It won't be found via the internal render API.")})]})},"no-type-warning")})}),e.jsxs("header",{className:"shrink-0 px-4 pb-6 pt-12 md:px-6 lg:px-6",children:[e.jsxs("button",{onClick:ve,className:"mb-4 flex items-center gap-2 font-mono text-[10px] uppercase tracking-widest text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(Bt,{size:14}),a?s("templates.detail.backToFolder","Back to Folder"):s("templates.detail.backToList","Back to Templates")]}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"mb-1 font-mono text-[10px] uppercase tracking-widest text-muted-foreground",children:s("templates.detail.header","Template Details")}),e.jsx(Xt,{value:m.title,onSave:Me,isLoading:pe.isPending,className:"font-display text-3xl font-light leading-tight tracking-tight text-foreground md:text-4xl"})]}),e.jsxs("button",{onClick:()=>d(!0),className:"group flex h-12 items-center gap-2 rounded-none bg-foreground px-6 text-sm font-medium tracking-wide text-background shadow-lg shadow-muted transition-colors hover:bg-foreground/90",children:[e.jsx(At,{size:20}),e.jsx("span",{children:s("templates.detail.createVersion","Create New Version")})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-12 md:px-6 lg:px-6",children:e.jsxs("div",{className:"grid gap-8 lg:grid-cols-[1fr_1.5fr]",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border border-border bg-background p-6",children:[e.jsx("h2",{className:"mb-4 font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:s("templates.detail.information","Information")}),e.jsxs("dl",{className:"space-y-4",children:[m.folder&&e.jsxs("div",{children:[e.jsxs("dt",{className:"mb-1 flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(zt,{size:12}),s("templates.detail.folder","Folder")]}),e.jsx("dd",{children:e.jsx("button",{onClick:Ze,className:"text-sm text-foreground underline-offset-2 hover:underline",children:m.folder.name})})]}),e.jsxs("div",{children:[e.jsxs("dt",{className:"mb-1 flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(Ae,{size:12}),s("templates.detail.createdAt","Created")]}),e.jsx("dd",{className:"text-sm text-foreground",children:Ce(m.createdAt)})]}),e.jsxs("div",{children:[e.jsxs("dt",{className:"mb-1 flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(ie,{size:12}),s("templates.detail.updatedAt","Last Updated")]}),e.jsx("dd",{className:"text-sm text-foreground",children:Ce(m.updatedAt)})]}),e.jsxs("div",{children:[e.jsxs("dt",{className:"mb-1 flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(Ot,{size:12}),s("templates.detail.versionsCount","Versions")]}),e.jsx("dd",{className:"text-sm text-foreground",children:((ye=m.versions)==null?void 0:ye.length)??0})]}),e.jsxs("div",{children:[e.jsxs("dt",{className:"mb-1 flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(Ut,{size:12,className:"shrink-0"}),e.jsx("span",{className:"shrink-0",children:s("templates.detail.documentType","Document Type")}),e.jsxs(ee.span,{animate:m.versions.some(i=>i.status==="PUBLISHED")&&!m.documentTypeId?{opacity:1,x:0,width:"auto",marginLeft:4}:{opacity:0,x:-20,width:0,marginLeft:0},transition:{duration:.2,ease:"easeInOut"},className:"inline-flex shrink-0 items-center gap-1 overflow-hidden border border-warning/50 bg-warning-muted/60 px-1.5 py-0.5 text-warning-foreground dark:border-warning-border dark:bg-warning-muted/50",children:[e.jsx(z,{size:10,className:"shrink-0"}),e.jsx("span",{className:"whitespace-nowrap font-mono text-[9px] uppercase tracking-widest",children:s("templates.warnings.noDocumentType","No type assigned")})]})]}),e.jsx("dd",{children:e.jsx(St,{currentTypeId:m.documentTypeId,currentTypeName:m.documentTypeName,onAssign:We,disabled:J.isPending})})]})]})]}),e.jsxs("div",{className:"border border-border bg-background p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:s("templates.detail.tags","Tags")}),e.jsx("button",{onClick:()=>p(!0),className:"text-muted-foreground transition-colors hover:text-foreground",title:s("templates.detail.editTags","Edit tags"),children:e.jsx(Se,{size:14})})]}),m.tags&&m.tags.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:m.tags.map(i=>e.jsx(Qt,{tag:i},i.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:s("templates.detail.noTags","No tags")})]})]}),e.jsxs("div",{className:"border border-border bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border p-4",children:[e.jsx("h2",{className:"font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:s("templates.detail.versionsSection","Version History")}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs(W,{children:[e.jsx(_,{asChild:!0,children:e.jsxs("button",{onClick:()=>Q(i=>({...i,PUBLISHED:!i.PUBLISHED})),disabled:N.PUBLISHED===0,className:k("flex items-center gap-1.5 rounded-sm border px-1.5 py-1 transition-colors",N.PUBLISHED===0?"cursor-not-allowed border-border bg-background text-muted-foreground opacity-30":O.PUBLISHED?"border-success-border/50 bg-success-muted text-success":"border-border bg-background text-muted-foreground opacity-50 hover:opacity-75"),children:[e.jsx(Ft,{size:14}),e.jsx("span",{className:"font-mono text-[10px]",children:N.PUBLISHED})]})}),e.jsx(K,{side:"bottom",className:"font-mono text-xs",children:s("templates.detail.filters.published","Publicadas")})]}),e.jsxs(W,{children:[e.jsx(_,{asChild:!0,children:e.jsxs("button",{onClick:()=>Q(i=>({...i,SCHEDULED:!i.SCHEDULED})),disabled:N.SCHEDULED===0,className:k("flex items-center gap-1.5 rounded-sm border px-1.5 py-1 transition-colors",N.SCHEDULED===0?"cursor-not-allowed border-border bg-background text-muted-foreground opacity-30":O.SCHEDULED?"border-info-border/50 bg-info-muted text-info":"border-border bg-background text-muted-foreground opacity-50 hover:opacity-75"),children:[e.jsx(ie,{size:14}),e.jsx("span",{className:"font-mono text-[10px]",children:N.SCHEDULED})]})}),e.jsx(K,{side:"bottom",className:"font-mono text-xs",children:s("templates.detail.filters.scheduled","Agendadas")})]}),e.jsxs(W,{children:[e.jsx(_,{asChild:!0,children:e.jsxs("button",{onClick:()=>Q(i=>({...i,DRAFT:!i.DRAFT})),disabled:N.DRAFT===0,className:k("flex items-center gap-1.5 rounded-sm border px-1.5 py-1 transition-colors",N.DRAFT===0?"cursor-not-allowed border-border bg-background text-muted-foreground opacity-30":O.DRAFT?"border-warning-border/50 bg-warning-muted text-warning-foreground":"border-border bg-background text-muted-foreground opacity-50 hover:opacity-75"),children:[e.jsx(De,{size:14}),e.jsx("span",{className:"font-mono text-[10px]",children:N.DRAFT})]})}),e.jsx(K,{side:"bottom",className:"font-mono text-xs",children:s("templates.detail.filters.draft","Borradores")})]}),e.jsxs(W,{children:[e.jsx(_,{asChild:!0,children:e.jsxs("button",{onClick:()=>Q(i=>({...i,ARCHIVED:!i.ARCHIVED})),disabled:N.ARCHIVED===0,className:k("flex items-center gap-1.5 rounded-sm border px-1.5 py-1 transition-colors",N.ARCHIVED===0?"cursor-not-allowed border-border bg-background text-muted-foreground opacity-30":O.ARCHIVED?"border-muted-foreground/30 bg-muted text-muted-foreground":"border-border bg-background text-muted-foreground opacity-50 hover:opacity-75"),children:[e.jsx(ae,{size:14}),e.jsx("span",{className:"font-mono text-[10px]",children:N.ARCHIVED})]})}),e.jsx(K,{side:"bottom",className:"font-mono text-xs",children:s("templates.detail.filters.archived","Archivadas")})]})]}),e.jsx("span",{className:"font-mono text-[10px] text-muted-foreground",children:s("templates.detail.versionsTotal","{{count}} version(s)",{count:ne.length})})]})]}),ne.length>0?e.jsx("div",{className:"divide-y divide-border",children:ne.map(i=>e.jsx(ts,{version:i,onOpenEditor:Ne,onPublish:et,onSchedule:tt,onCancelSchedule:nt,onArchive:ot,onDelete:at,onClone:it},i.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(De,{size:32,className:"mb-3 text-muted-foreground/50"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("templates.detail.noVersions","No versions yet")}),e.jsx("button",{onClick:()=>d(!0),className:"mt-4 text-sm text-foreground underline underline-offset-4 hover:no-underline",children:s("templates.detail.createFirstVersion","Create first version")})]})]})]})}),e.jsx(_t,{open:c,onOpenChange:d,templateId:t}),e.jsx(Gt,{open:u,onOpenChange:p,templateId:t,currentTags:m.tags??[]}),e.jsx(Yt,{open:j,onOpenChange:f,version:F,onConfirm:st,isLoading:ge.isPending}),e.jsx(Jt,{open:v,onOpenChange:g,version:F,onConfirm:rt,isLoading:fe.isPending}),e.jsx(Zt,{open:w,onOpenChange:x,validation:h,onOpenEditor:F?()=>Ne(F.id):void 0}),e.jsx(Kt,{open:Ee,onOpenChange:ce,version:Ve,templateId:t}),e.jsx($t,{open:Le,onOpenChange:ue,version:Fe,templateId:t}),e.jsx(Mt,{open:Re,onOpenChange:me,version:Ue,templateId:t}),e.jsx(Wt,{open:ze,onOpenChange:xe,templateId:t,sourceVersion:Oe}),e.jsx(Tt,{open:Y.open,conflictTemplate:Y.conflict,onCancel:Ke,onForce:_e,isLoading:J.isPending})]})}const Ds=ss;export{Ds as component};
