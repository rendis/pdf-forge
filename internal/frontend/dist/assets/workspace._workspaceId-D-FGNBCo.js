import{i as ae,p as ne,r as c,j as e,T as C,k,e as p,m as u,n as S,o as se,q as M,s as ie,u as $,f as z,b as E,c as re,t as R,A as oe,v as le,w as ce,O as de}from"./index-BQwHK-hb.js";import{B as F}from"./button-C4PvoC7_.js";import{u as H,C as ue}from"./dropdown-menu-C7jJ2Coz.js";import{P as me,s as xe,U as fe,S as pe,L as he,M as ge}from"./index-Buhrcxhh.js";import{P,S as ve}from"./scroll-area-Bz3tbPNu.js";import{F as B}from"./file-text-BQtqwPe2.js";import{F as be}from"./folder-open-BIADOphw.js";import{V as je}from"./variable-Cg9_jezD.js";import{S as we,a as Ne,b as ye,c as Ce,d as ke}from"./sheet-Bebdwbk9.js";import{L as Se,T as Me}from"./ThemeToggle-BhXcnR67.js";import"./index-BdQq_4o_.js";import"./index-BUG7Fq1L.js";import"./i18n-eAKqvBWy.js";const Le=1024,w=ae()(ne((t,n)=>({isCollapsed:!1,isMobileOpen:!1,isPinned:!0,isHovering:!1,toggleCollapsed:()=>t({isCollapsed:!n().isCollapsed}),setCollapsed:a=>t({isCollapsed:a}),toggleMobileOpen:()=>t({isMobileOpen:!n().isMobileOpen}),setMobileOpen:a=>t({isMobileOpen:a}),closeMobile:()=>t({isMobileOpen:!1}),togglePinned:()=>{const a=!n().isPinned;t({isPinned:a,isHovering:!1})},setPinned:a=>t({isPinned:a,isHovering:!1}),setHovering:a=>t({isHovering:a})}),{name:"doc-assembly-sidebar",partialize:t=>({isCollapsed:t.isCollapsed,isPinned:t.isPinned})}));function Ae(){const t=w(a=>a.closeMobile),n=w(a=>a.isMobileOpen);c.useEffect(()=>{if(typeof window>"u")return;const a=()=>{window.innerWidth>=Le&&n&&t()};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[t,n])}function Pe({className:t}){const{t:n}=H(),{isPinned:a,togglePinned:s}=w(),o=n(a?"sidebar.unpin":"sidebar.pin");return e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx(F,{variant:"outline",size:"icon",onClick:s,"aria-label":o,className:p("absolute right-0 top-1/2 z-10 h-7 w-7 -translate-y-1/2 translate-x-1/2 rounded-full border bg-background shadow-sm transition-all hover:scale-105 hover:bg-accent",a&&"border-admin/50 bg-background",t),children:e.jsx(u.div,{initial:!1,animate:{rotate:a?45:0},transition:{duration:.2,ease:[.4,0,.2,1]},children:e.jsx(me,{size:14,className:p("transition-colors duration-200",a?"fill-admin text-admin":"text-muted-foreground")})})})}),e.jsx(S,{side:"right",sideOffset:8,children:o})]})}function Te(t,n=[]){let a=[];function s(r,l){const i=c.createContext(l);i.displayName=r+"Context";const d=a.length;a=[...a,l];const x=f=>{var y;const{scope:m,children:b,...g}=f,j=((y=m==null?void 0:m[t])==null?void 0:y[d])||i,N=c.useMemo(()=>g,Object.values(g));return e.jsx(j.Provider,{value:N,children:b})};x.displayName=r+"Provider";function h(f,m){var j;const b=((j=m==null?void 0:m[t])==null?void 0:j[d])||i,g=c.useContext(b);if(g)return g;if(l!==void 0)return l;throw new Error(`\`${f}\` must be used within \`${r}\``)}return[x,h]}const o=()=>{const r=a.map(l=>c.createContext(l));return function(i){const d=(i==null?void 0:i[t])||r;return c.useMemo(()=>({[`__scope${t}`]:{...i,[t]:d}}),[i,d])}};return o.scopeName=t,[s,Ie(o,...n)]}function Ie(...t){const n=t[0];if(t.length===1)return n;const a=()=>{const s=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(r){const l=s.reduce((i,{useScope:d,scopeName:x})=>{const f=d(r)[`__scope${x}`];return{...i,...f}},{});return c.useMemo(()=>({[`__scope${n.scopeName}`]:l}),[l])}};return a.scopeName=n.scopeName,a}function Oe(){return xe.useSyncExternalStore(Re,()=>!0,()=>!1)}function Re(){return()=>{}}var T="Avatar",[_e]=Te(T),[$e,W]=_e(T),V=c.forwardRef((t,n)=>{const{__scopeAvatar:a,...s}=t,[o,r]=c.useState("idle");return e.jsx($e,{scope:a,imageLoadingStatus:o,onImageLoadingStatusChange:r,children:e.jsx(P.span,{...s,ref:n})})});V.displayName=T;var U="AvatarImage",D=c.forwardRef((t,n)=>{const{__scopeAvatar:a,src:s,onLoadingStatusChange:o=()=>{},...r}=t,l=W(U,a),i=ze(s,r),d=se(x=>{o(x),l.onImageLoadingStatusChange(x)});return M(()=>{i!=="idle"&&d(i)},[i,d]),i==="loaded"?e.jsx(P.img,{...r,ref:n,src:s}):null});D.displayName=U;var q="AvatarFallback",G=c.forwardRef((t,n)=>{const{__scopeAvatar:a,delayMs:s,...o}=t,r=W(q,a),[l,i]=c.useState(s===void 0);return c.useEffect(()=>{if(s!==void 0){const d=window.setTimeout(()=>i(!0),s);return()=>window.clearTimeout(d)}},[s]),l&&r.imageLoadingStatus!=="loaded"?e.jsx(P.span,{...o,ref:n}):null});G.displayName=q;function _(t,n){return t?n?(t.src!==n&&(t.src=n),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ze(t,{referrerPolicy:n,crossOrigin:a}){const s=Oe(),o=c.useRef(null),r=s?(o.current||(o.current=new window.Image),o.current):null,[l,i]=c.useState(()=>_(r,t));return M(()=>{i(_(r,t))},[r,t]),M(()=>{const d=f=>()=>{i(f)};if(!r)return;const x=d("loaded"),h=d("error");return r.addEventListener("load",x),r.addEventListener("error",h),n&&(r.referrerPolicy=n),typeof a=="string"&&(r.crossOrigin=a),()=>{r.removeEventListener("load",x),r.removeEventListener("error",h)}},[r,a,n]),l}var K=V,X=D,Y=G;const L=c.forwardRef(({className:t,...n},a)=>e.jsx(K,{ref:a,className:p("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...n}));L.displayName=K.displayName;const Ee=c.forwardRef(({className:t,...n},a)=>e.jsx(X,{ref:a,className:p("aspect-square h-full w-full",t),...n}));Ee.displayName=X.displayName;const A=c.forwardRef(({className:t,...n},a)=>e.jsx(Y,{ref:a,className:p("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...n}));A.displayName=Y.displayName;const Fe={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0}},He={hidden:{opacity:0,scale:0},visible:{opacity:1,scale:1}};function J({isExpanded:t,onNavigate:n,showAnimations:a=!0}){const{t:s}=H(),o=ie(),r=$(),{userProfile:l}=z(),{currentWorkspace:i,clearContext:d,isSystemContext:x}=E(),{phase:h}=re(),f=h==="idle"||h==="complete",m=(i==null?void 0:i.id)||"",g=[{label:s("nav.templates"),icon:B,href:`/workspace/${m}/templates`},{label:s("nav.documents"),icon:be,href:`/workspace/${m}/documents`},{label:s("nav.variables"),icon:je,href:`/workspace/${m}/variables`},{label:s("nav.members","Members"),icon:fe,href:`/workspace/${m}/members`},...x()?[{label:s("nav.administration","Administration"),icon:pe,href:`/workspace/${m}/administration`}]:[]],j=l&&(`${l.firstName||""} ${l.lastName||""}`.trim()||l.username)||"User",N=(l==null?void 0:l.email)||"user@example.com",y=R(j),Q=async()=>{n==null||n(),d(),await ce(),r({to:"/login"})},Z=()=>{n==null||n()},ee=v=>o.pathname.startsWith(v),I=a?.8:0;return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{className:p("flex-1 py-6",t?"px-4":"px-2"),children:[i&&e.jsxs("div",{className:"relative mb-8 px-1",children:[e.jsx(u.div,{initial:!1,animate:{opacity:t||!f?0:1,scale:t?.8:1},transition:{duration:.2,ease:[.4,0,.2,1]},className:"absolute inset-0 flex items-center",style:{pointerEvents:t||!f?"none":"auto"},children:e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx(L,{className:"h-10 w-10 cursor-default",children:e.jsx(A,{className:"bg-primary/10 text-sm font-bold",children:R(i.name)})})}),e.jsxs(S,{side:"right",sideOffset:8,children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:s("workspace.current")}),e.jsx("div",{className:"font-medium",children:i.name})]})]})}),e.jsx(u.div,{initial:!1,animate:{opacity:t?1:0,x:t?0:-10},transition:{duration:.2,ease:[.4,0,.2,1]},className:"flex h-10 items-center",style:{pointerEvents:t?"auto":"none"},children:e.jsxs("div",{style:{opacity:f?1:0},children:[e.jsx("label",{className:"block text-[10px] font-mono uppercase tracking-widest text-muted-foreground",children:s("workspace.current")}),e.jsx("div",{className:"truncate font-display text-lg font-medium",children:i.name})]})})]}),e.jsx("nav",{className:"space-y-1",children:e.jsx(oe,{mode:"popLayout",initial:!1,children:g.map((v,te)=>{const O=ee(v.href);return e.jsx(u.div,{children:e.jsx(u.div,{variants:a?Fe:void 0,initial:a?"hidden":!1,animate:a?"visible":!1,transition:{duration:.3,delay:I+te*.08},children:e.jsxs(le,{to:v.href,onClick:Z,className:p("group flex w-full items-center gap-4 rounded-md px-3 py-3 text-sm font-medium transition-colors",O?"bg-sidebar-accent text-sidebar-accent-foreground":"text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground"),children:[e.jsx(v.icon,{size:20,strokeWidth:1.5,className:p("shrink-0",O?"text-sidebar-accent-foreground":"text-muted-foreground group-hover:text-sidebar-accent-foreground")}),e.jsx(u.span,{initial:!1,animate:{opacity:t?1:0,width:t?"auto":0},transition:{duration:.15,ease:[.4,0,.2,1]},className:"overflow-hidden whitespace-nowrap font-mono",children:v.label})]})})},v.href)})})})]}),e.jsxs("div",{className:p("border-t py-4",t?"px-4":"px-2"),children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-md px-2 py-2",children:[e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx(L,{className:"h-8 w-8 shrink-0 cursor-default",children:e.jsx(A,{className:"text-xs font-bold",children:y})})}),!t&&e.jsxs(S,{side:"right",sideOffset:8,children:[e.jsx("div",{className:"font-medium",children:N}),e.jsx("div",{className:"text-xs text-muted-foreground",children:(i==null?void 0:i.role)||"Member"})]})]}),e.jsxs(u.div,{initial:!1,animate:{opacity:t?1:0,width:t?"auto":0},transition:{duration:.15,ease:[.4,0,.2,1]},className:"min-w-0 overflow-hidden",children:[e.jsx("div",{className:"truncate text-xs font-semibold whitespace-nowrap",children:N}),e.jsx("div",{className:"text-[10px] uppercase text-muted-foreground whitespace-nowrap",children:(i==null?void 0:i.role)||"Member"})]})]}),e.jsx(u.div,{variants:a?He:void 0,initial:a?"hidden":!1,animate:a?"visible":!1,transition:{duration:.3,delay:I},children:e.jsxs("button",{onClick:Q,className:"group flex w-full items-center gap-4 rounded-md px-3 py-3 text-sm font-medium text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(he,{size:20,strokeWidth:1.5,className:"shrink-0 transition-transform group-hover:-translate-x-1"}),e.jsx(u.span,{initial:!1,animate:{opacity:t?1:0,width:t?"auto":0},transition:{duration:.15,ease:[.4,0,.2,1]},className:"overflow-hidden whitespace-nowrap font-mono",children:s("nav.logout")})]})})]})]})}function Be(){const{isPinned:t,isHovering:n,closeMobile:a}=w(),s=t||n;return e.jsxs(u.aside,{initial:!1,animate:{width:s?256:64},transition:{duration:.2,ease:[.4,0,.2,1]},className:p("relative flex h-full flex-col overflow-visible bg-sidebar-background pt-16"),children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(Pe,{})}),e.jsx(u.div,{className:"absolute right-0 top-0 bottom-0 w-px bg-border origin-top",initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.5,delay:.3}}),e.jsx(J,{isExpanded:s,onNavigate:a,showAnimations:!0})]})}function We(){const{isMobileOpen:t,closeMobile:n}=w();return e.jsx(we,{open:t,onOpenChange:a=>!a&&n(),children:e.jsxs(Ne,{side:"left",className:"flex w-[280px] flex-col p-0 pt-16",children:[e.jsxs(ye,{className:"sr-only",children:[e.jsx(Ce,{children:"Navigation Menu"}),e.jsx(ke,{children:"Main navigation sidebar"})]}),e.jsx(J,{isExpanded:!0,onNavigate:n,showAnimations:!1})]})})}function Ve({className:t}){const n=$(),{currentTenant:a,currentWorkspace:s,setCurrentWorkspace:o,setCurrentTenant:r,singleTenant:l,singleWorkspace:i}=E(),d=z(b=>b.isSuperAdmin());if(!a)return null;const x=!l||d,h=!i||d,f=()=>{r(null),n({to:"/select-tenant",search:{intent:"switch"}})},m=()=>{o(null),n({to:"/select-tenant",search:{intent:"switch"}})};return e.jsxs(u.nav,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},className:p("flex items-center gap-2",t),"aria-label":"Context navigation",children:[e.jsx("span",{className:"text-border",children:"Â·"}),x?e.jsx("button",{onClick:f,className:"max-w-[120px] truncate font-mono text-xs text-muted-foreground transition-colors hover:text-foreground md:max-w-[180px]",title:a.name,children:a.name}):e.jsx("span",{className:"max-w-[120px] truncate font-mono text-xs text-muted-foreground md:max-w-[180px]",title:a.name,children:a.name}),s&&e.jsxs(e.Fragment,{children:[e.jsx(ue,{size:12,className:"text-muted-foreground/50"}),h?e.jsx("button",{onClick:m,className:"max-w-[120px] truncate font-mono text-xs text-muted-foreground transition-colors hover:text-foreground md:max-w-[180px]",title:s.name,children:s.name}):e.jsx("span",{className:"max-w-[120px] truncate font-mono text-xs text-muted-foreground md:max-w-[180px]",title:s.name,children:s.name})]})]})}function Ue({variant:t="minimal",className:n,showMobileMenu:a=!1,onMobileMenuToggle:s}){const o=t==="minimal";return e.jsxs(u.header,{className:p("fixed left-0 right-0 top-0 z-50 flex h-16 items-center justify-between bg-background",o?"px-6 md:px-12 lg:px-32":"px-4 sm:px-6",n),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a&&e.jsx(F,{variant:"ghost",size:"icon",onClick:s,className:"shrink-0 lg:hidden","aria-label":"Toggle navigation menu",children:e.jsx(ge,{className:"h-5 w-5"})}),e.jsxs(u.div,{layoutId:"app-logo",className:"flex items-center gap-3",children:[e.jsx(u.div,{layoutId:"app-logo-icon",className:"flex h-8 w-8 items-center justify-center border-2 border-foreground",children:e.jsx(B,{size:16,className:"text-foreground"})}),e.jsx(u.span,{layoutId:"app-logo-text",className:"font-display text-lg font-bold uppercase tracking-tight text-foreground",children:"PDF Forge"})]}),!o&&e.jsx("div",{className:"hidden sm:block",children:e.jsx(Ve,{})})]}),e.jsxs(u.div,{layoutId:"app-controls",className:"flex shrink-0 items-center gap-1",children:[e.jsx(Se,{}),e.jsx(Me,{})]}),e.jsx(u.div,{className:"absolute bottom-0 left-0 right-0 h-px bg-border origin-left",initial:{scaleX:0},animate:{scaleX:o?0:1},transition:{duration:.5,delay:.3}})]})}const De={initial:{opacity:1},animate:{opacity:1}};function qe(){const{toggleMobileOpen:t,isPinned:n,setHovering:a}=w(),s=c.useRef(null);Ae();const o=c.useCallback(()=>{n||(s.current&&(clearTimeout(s.current),s.current=null),a(!0))},[n,a]),r=c.useCallback(()=>{n||(s.current=setTimeout(()=>{a(!1)},150))},[n,a]);return c.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]),e.jsxs("div",{className:"flex h-screen overflow-hidden bg-background",children:[e.jsx(Ue,{variant:"full",showMobileMenu:!0,onMobileMenuToggle:t}),e.jsx(We,{}),e.jsx(u.div,{variants:De,initial:"initial",animate:"animate",className:"hidden lg:block lg:relative",onMouseEnter:o,onMouseLeave:r,children:e.jsx(Be,{})}),e.jsx("main",{className:"flex flex-1 flex-col overflow-hidden pt-16",children:e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(de,{})})})]})}function rt(){return e.jsx(qe,{})}export{rt as component};
